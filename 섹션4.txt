클라우드 가상 서버

-> 이 가상 서버 하나는 인스턴스라고 부름


ec2 구성
1. 이름 및 태그 -> 이름과 태그를 통해 인스턴스를 그룹화하여 관리 간으


2. 애플리케이션 및 os이미지
-> 인스턴스 OS 이미지 AIM 설정


3. 인스턴스 유형
-> cpu 메모리 등의 하드웨어 사양 설정

4. 키페어
-> ec2 서버 접속 관련 인증키(SSH)

5. 네트워크 설정
-> vpc, subnet, 방화벽 설정

6. 스토리지
-> 디스크 관련 설정

7. 고급 세부정보

-> 추가 기능


ssh 접속->
클라이언트와 서버간에 통신되는 데이터를 암호화 해서 처리 
비공개 키, 공개 키를 나누고
공개키를 등록 비공개키를 통해 데이터를 암호화
이 키를 가지고 서로 암호화 수행


윈도우는 rdp방식이 있음. 아이디, 패스워드로 접속


ssh -i "kmp2.pem" ec2-user@ec2-13-125-130-231.ap-northeast-2.compute.amazonaws.com



-인스턴스 구매옵션

온디맨드 인스턴스: 약정 없이 초당 사용 비용을 지불 
- 처음 60초 이후 초당 과금
-장기 약정이나 선 결제 없음
-단기간 동안 예측할 수 없는 워크로드 및 중단되면 안되면 어플리케이션
- 여기서 비용을 대폭 줄이려먼 aws saving plans spot instances 또는 Reserved instance를 사용


예약 인스턴스: 1년, 3년 등의 약정을 정하고 인스턴스 비용 지불(시간)
- 1년 혹은 3년 약정으로 구매
- 온디맨드에 비해 최대 72% 저렴(할인은 AWS정책에 따라 변경)
-  수요가 꾸준하고 예측가능한 경우
- 전체 선결제, 부분결제, 선결제없음
- 표준 예약 인스턴스: 인스턴스 타입을 중간에 변경 불가능
- 전환형 예약 인스턴스: 예약기간동안 변경 가능
- 남은 약정ㅇ을 마켓 플레이스에 판매 가능

세이빙 플랜: 1년, 3년 등의 일정 사용량 설정하고 시간당 요금으로 지불(사용량)
-일정 사용량 약정으로 구매하는 인스턴스
- 한시간에 5달러 의 컴퓨팅 사용량을 약정하면 5달러까지 세이빙플랜 가격 청구 되고 초과시에는 온디맨드 요금 부과

스팟 인스턴스: 현재 사용하지 않는 예비 용량의 인스턴스를 구매하여 사용
- 예비 용량을 구매하여 사용하는 방식
- 단, 수요에 따라 언제든지 인스턴스가 종료될 수 있음.
- 최대 90%까지 저렴
- 유연한 상태 비저장, 빅데이터, 컨테이너화된 워크로드, CI/CD  등등 중간에 꺼져도 상관 없는 것
-spot fleet: 여러개의 스팟 인스턴스를 하나의 그룹으로 묶음
- ec2 fleet: 예약 혹은 온디맨드 인스턴스 사용하다가 급격한 트래픽 증가에 스팟 플릿 인스턴스를 이용하여 대응

전용 호스트/전용 인스턴스: 전용 물리적 서버를 할당 받아서 사용

온디맨드 용량 예약: 원하는 기간 동안 특정 가용 영역의 용량을 예약하여 사용
-> 재해복구, 이벤트 등 특정 사건에 대응



-인스턴스 유형
cpu,메모리, 스토리지,네트워킹 용량의 여러 조합으로 구성됨

목적에 따라
범용, 컴퓨팅 최적화 메모리 최적화, 가속화된 컴퓨팅, 스토리지 최적화, HPC 최적화 인스턴스 패밀리로 구성됨



- 네트워킹/ 네트워크 인터페이스

awscloud -> vpc -> az -> subnet 안에 인스턴스 ip, 인스턴스 할당  ENI를 할당 받아서 퍼블릿, 프라이빗 ip 할당

eni -> 가상 네트워크 인터페이스 가상의 IP,MAC주소 할당 ec2에 여러개의 네트워크 인터페이스 연결 가능
ec2랑 같은 가용 용역에 있는 것만 가능, 하나 이상의 보안그룹과 연결 가능


-보안 그룹

인바운드 아웃바운드 트래픽 을 제어하는 가상 방화벽

eni와 연결

보안그룹은 허용 규칙만 정하고 허용 규칙에 없는 것은 모두 거부

보안그룹은 연결상태를 추적하는 상태저장 방화벽 이와 반대되는 acl(상태비저장)

인스턴스 앞에서 트래픽을 통제

인바운드 -> 외부에서 ec2에 들어오는 트래픽
아웃바운드 -> ec2에서 외부로 나가는 트래픽

제어규칙 : 프로토콜 , 트래픽 유형, 포트, 개별 IP주소, CIDR, prefix lsit, 보안그룹으로 대상을 지정

상태저장: -> 아웃바운드 규칙에 상관없이 허용된 인바운드는 자동으로 아웃바운드도 가능 -> 들어갈때 마음대로 나갈때도 마음대로
상태비저장 -> 들어갈때는 마음대로 나갈때는 마음대로 아님.


엘라스틱 IP

인스턴스 생성시 자동으로 할당 받은 public ip는 재 시작시 다시 새로운 ip를 재할당 받음
이를 막기 위해서 고정적인 퍼블릭 ip를 엘라스틱 ip가 제공함.

eni에 엘라스틱ip를 할당하는 식으로 함.
엘라스틱ip는 생성된 리전에서만 사용가능
엘라스틱ip를 사용하면 과금 안됨 하지만 ec2에 연결되지않은 엘라스틱 ip는 과금이 됨.


ami

인스턴스를 시작하는데 필요한 소프트웨어 구성(운영체제, 애플리케이션 등)이 포함된 템플릿


- 배치그룹 -> 좀더 공부
사용자가 ec2인스턴스 그룹의 배치를 구성
유형
- 클러스터 배치그룹
단일 가용영역내에 고속 네트워크로 연결

- 파티션 배치그룹
인스턴스 그룹을 하드웨어를 공유하지 않는 파티션 단위로 분할 -> 각 파티션마다 영향을 없음 각 파티션에 각각의 자원을 할당
-> hdfs, hbase, 카산드라 등 빅데이터 분산처리시스템에 사용 -> 각 파티션 내에서는 같은 하드웨어 공유

-분산형 배치그룹
그룹 내의 각 개별 인스턴스가 서로 다른 하드웨어에 배치
-> 각각 고유한 하드웨어에 배치된 인스턴스 그룹

매우 중요하고 고가용성이 필요한 어플리케이션


-ec2 라이프사이클

인스턴스 시작부터 종료까지의 다양한 상태

행동
시작: 전원 키기
재부팅: 전원 다시 키기
중지: 전원을 끔
최대절전: 절전모드와 비슷 ram에 있는 것을 루트볼륨에 저장
종료: 인스턴스를 끔

상태
실행중
중지됨
종료됨

종료, 중지된 ec2는 시간 당 사용 요금이 부과되지 않지만 ebs스토리지에 대한 비용은 부과





